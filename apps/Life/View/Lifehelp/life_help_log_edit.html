<extend name="./apps/Common/Template/temp.html" />
<block name="css"></block>
<block name="body">
        <div class="page-container">
            <!-- BEGIN CONTENT -->
            <div class="page-content-wrapper">
                <!-- BEGIN CONTENT BODY -->
                <div class="page-content">
                    <!-- 添加开始 -->
					<form action="{:U('life_help_log_save')}" id="form_sample_2" class="form-horizontal" method="post">
                    	<!-- 开始 -->
                    	<input type="hidden" class="form-control " name="help_log_id" value="{$help_log_data.help_log_id}"/>
                    	<input type="hidden" name="communist_no" value="{$help_log_data[communist_no]}" id="workers"/>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="portlet light bordered">
                                    <div class="portlet-title">
                                        <div class="caption">
                                            <div class="cont-col1">
                                                <div class="label label-sm bg-color-green">
                                                    <i class="iconfont">&#xe650;</i>
                                                </div>
                                            </div>
                                            <span class="bold "><php>echo getFunctionInfo(ACTION_NAME);</php></span>
                                        </div>
                                        <div class="tools">
                                            <a href="" class="reload"> </a>
                                            <a href="" class="collapse"> </a>
                                        </div>
                                    </div>
                                    <div class="portlet-body right">
                                    	<div class="row p5-editor-move">
	                                        <!-- 输入姓名开始   -->
	                                        <div class="form-group  mt-5 col-md-5 ">
	                                            <div class="row">
	                                                <label class="control-label col-md-4 pl-0 lh-30 lh-30">姓名：<span class="required"> * </span>
	                                                </label>
	                                                <div class="col-md-6 p5-form-control pl-0">
	                                                    <div class="input-icon right">
	                                                        <i class="fa"></i>
	                                                        <input type="text" class="  form-control " name="help_log_name" value="{$help_log_data.help_log_name}"/> </div>
	                                                </div>
	                                            </div>
	                                        </div>
	                                        <!-- 输入姓名结束 -->
	                                        <!-- 联系方式开始 -->
											<div class="form-group  mt-5 col-md-5 ">
												<div class="row">
													<label class="control-label col-md-4 pl-0 lh-30 lh-30">联系方式：<!-- <span class="required"> * </span> -->
													</label>
													<div class="col-md-6 p5-form-control pl-0">
														<div class="input-icon right">
															<i class="fa"></i>
														   <input type="text"  class="form-control layer-date "  name="help_log_tel" value="{$help_log_data.help_log_tel}"/>
														</div>
													</div>
												</div>
											</div>
											<!-- 联系方式结束 -->
											<!-- 输入帮扶时间开始   -->
	                                        <div class="form-group  mt-8 col-md-5 ">
	                                            <div class="row">
		                                            <label class="control-label col-xs-4 pl-0 lh-30 lh-30">帮扶时间：
		                                              <span class="required"> * </span>
		                                            </label>
		                                            <div class="col-md-6 p5-form-control pl-0">
		                                                <input type="text" value="{$help_log_data.help_log_time}" required name="help_log_time" id="commu_time" date class="form-control layer-date " placeholder="选择日期" >
		                                            </div>
	                                        	</div>
											</div>		
											<div class="form-group style="height:50px" mt-3 col-md-5 ">
	                                            <div class="row">
		                                            
	                                        	</div>
											</div>		
	                                        <!-- 输入帮扶时间结束 -->
	                                        <!-- 横向单选按钮 -->
	                                        <!-- 帮扶对象开始 -->
		                                    <div class="form-group  mt-5 col-md-5 ">
												<div class="row">
													<label class="control-label col-md-4 pl-0 lh-30 lh-30">帮扶对象:
														<span class="required">  </span> 
													</label>
													<div class="col-md-6 p5-form-control pl-0">
														<div class="input-icon right">
															<select name="help_log_type" id="help_log_type" class="  form-control  select2" onchange="change_type()">
																<option value="1" selected>贫困村</option>
																<option value="2">贫困户</option>
															</select>
														</div>
													</div>
												</div>
											</div>
	                                        <!-- 选择村和户 -->
	                                        <div class="form-group  mt-5 col-md-5 ">
												<div class="row" id="village">
													<label class="control-label col-md-4 pl-0 lh-30 lh-30">选择村:
														<span class="required">  </span> 
													</label>
													<div class="col-md-6 p5-form-control pl-0">
														<div class="input-icon right">
															<select  name="help_log_object_name" class="  form-control  select2">
																<option value="">选择村</option>
																<option value="1">22村</option>
																<option value="2">33村</option>
															</select>
														</div>
													</div>
												</div>

												<div class="row" id="households" style="display:none">
													<label class="control-label col-md-4 pl-0 lh-30 lh-30">选择户:
														<span class="required">  </span> 
													</label>
													<div class="col-md-6 p5-form-control pl-0">
														<div class="input-icon right">
															<select  name="help_log_object_name" class="  form-control  select2">
																<option value="">选择户</option>
																<option value="1">22户</option>
																<option value="2">33户</option>
															</select>
														</div>
													</div>
												</div>
											</div>
											<!-- 帮扶对象结束 -->
											<!-- 帮扶措施开始 -->
											<div class="form-group  mt-5 col-md-5 ">
	                                            <div class="row">
	                                                <label class="control-label col-md-4 pl-0 lh-30 lh-30">帮扶措施：<span class="required"> * </span>
	                                                </label>
	                                                <div class="col-md-6 p5-form-control pl-0">
	                                                    <div class="input-icon right">
	                                                        <i class="fa"></i>
	                                                        <textarea name="help_log_measures" rows="7" cols="90">{$help_log_data.help_log_measures}</textarea></div>
	                                                </div>
	                                            </div>
	                                        </div>
	                                        <!-- 帮扶措施结束 -->
											<div class="row">
						                        <div class="col-md-12 mb-30">
						                            <a type="button"  class="btn btn-sm default w-75 bor-ra-2 pull-right mr-20" onclick="history.go(-1)">取消</a>
													<button style="margin-right:10px" type="submit" style="margin-right:15px" id="btnSave" class="btn btn-sm blue w-75 bor-ra-2 pull-right">提交</button>
						                        </div>
						                    </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- 结束 -->
					 </form>
                </div>
            </div>
        </div>
     </block>
	<block name="js">
		<script>
		function change_type(){
			var type =$('#help_log_type option:selected').val();
			if(type == 1){
				$("#village").show();
				$("#households").hide();
			} else {
				$("#village").hide();
				$("#households").show();
			}
			
		}
		</script>
			<script>
			laydate.render({
				elem: '#commu_time',
				type: 'datetime'
			}); 
		</script>
        <script >
            var um = UM.getEditor('editor');
           /* laydate.render({
    		    elem: '#time',
    		  });*/

        </script>
        <script>
        	//手机验证
        	var help_log_tel = $('input[name="help_log_tel"]');
			help_log_tel.change(function(){
				
				if(!(/^1[34578]\d{9}$/.test(help_log_tel.val()))){
			        $(this).css('border',"1px solid #e73d4a");
			        return false; 
			    }
				$(this).css('border',"1px solid #27a4b0");
			})
        </script>
        <script >
	     /*帮扶党员多选*/
		 $('#worker').change(function(){
		 	var v =$("#worker").select2("val");
				$("#workers").val(v);
		 });
			
		</script>
		<script >
			$(document).ready(function(){
				$(".multiSelect").select2();
				$("#btnSave").click(function(){
					var v =$("#worker").select2("val");
					$("#workers").val(v);
					$("#form_sample_2").submit();//myform表单的id
				});
			});
		</script>
		<script>
			var FormValidation = function () {
				var handleValidation2 = function() {
					var form2 = $('#form_sample_2');
					var error2 = $('.alert-danger', form2);
					var success2 = $('.alert-success', form2);
					form2.validate({
						errorElement: 'span', //default input error message container
						errorClass: 'help-block help-block-error', // default input error message class
						focusInvalid: false, // do not focus the last invalid input
						ignore: "",  // validate all fields including form hidden input
						rules: {
							help_log_name: {
								required: true
							},help_log_time: {
								required: true,
								
							},help_log_measures: {
								
								required: true,
							// }, help_idnumber: {
							// 	required: true
							// }, help_nativeplace: {
							// 	required: true
							}/* ,communist_no:{
								required: true
							} */
						},

						invalidHandler: function (event, validator) { //display error alert on form submit
							success2.hide();
							error2.show();
							App.scrollTo(error2, -200);
						},

						errorPlacement: function (error, element) { // render error placement for each input type
							var icon = $(element).parent('.input-icon').children('i');
							icon.removeClass('fa-check').addClass("fa-warning");
							icon.attr("data-original-title", error.text()).tooltip({'container': 'body'});
						},

						highlight: function (element) { // hightlight error inputs
							$(element)
								.closest('.form-group').removeClass("has-success").addClass('has-error'); // set error class to the control group
						},

						unhighlight: function (element) { // revert the change done by hightlight

						},

						success: function (label, element) {
							var icon = $(element).parent('.input-icon').children('i');
							$(element).closest('.form-group').removeClass('has-error').addClass('has-success'); // set success class to the control group
							icon.removeClass("fa-warning").addClass("fa-check");
						},

						submitHandler: function (form) {
							success2.show();
							error2.hide();
							form[0].submit(); // submit the form
						}
					});
				}
				var handleWysihtml5 = function() {
					if (!jQuery().wysihtml5) {

						return;
					}

					if ($('.wysihtml5').size() > 0) {
						$('.wysihtml5').wysihtml5({
							"stylesheets": ["../assets/global/plugins/bootstrap-wysihtml5/wysiwyg-color.css"]
						});
					}
				}
				return {
					//main function to initiate the module
					init: function () {
						handleWysihtml5();
						handleValidation2();
					}
				};
			}();
			jQuery(document).ready(function() {
				FormValidation.init();
			});
			</script>
	</block>