<!DOCTYPE html>
<html>

<head>
<meta charset="UTF-8">
<meta name="viewport"
	content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
<title>考试中心</title>
<!-- aui核心css -->
<link rel="stylesheet" type="text/css" href="__STATICS__/apps/page_wechat/public/aui2/css/aui.css" />
<!-- end -->
<!--公用css-->
<link rel="stylesheet" type="text/css" href="__STATICS__/apps/page_wechat/public/css/sp_public.css"/>
<!-- end -->
<!-- 轮播 -->
<link rel="stylesheet" type="text/css" href="__STATICS__/apps/page_wechat/public/aui2/css/aui-slide.css" />
<!-- end -->
<!-- 本项目公共css -->
<link rel="stylesheet" type="text/css" href="__STATICS__/apps/page_wechat/public/css/sp_public_mobile.css"/>
<!-- bootstrap -->
<link rel="stylesheet" href="__STATICS__/apps/page_wechat/public/css/icheck-bootstrap.css">
<!-- message -->
<link rel="stylesheet" href="__STATICS__/apps/page_wechat/public/css/message.css">
<!-- end -->
<!--本页面css-->
<link rel="stylesheet" type="text/css" href="__STATICS__/apps/page_wechat/edu/css/edu_exam.css" />
<link rel="stylesheet" type="text/css" href="__STATICS__/apps/page_wechat/edu/css/edu_exam_info.css" />
<style>
header {
	background-color: #fff !important;
	line-height: 3rem !important;
	position: fixed !important;
	top: 0 !important;
}
.h-45em {
    height: 1.25rem !important;
}
#aui-content {
	margin-top: 1.5rem !important;
}
.questionId {
	cursor: pointer;
	font-size: 0.8rem;
	line-height: 1.7rem;
	text-align: center;
	color: #DCE7F2;
	border: 0.03rem solid white !important;
}
.question_id {
	color: #FFF;
	background: #d4a500;
	border: 0.03rem solid #d4a500 !important;
}
.question_id_yikao {
	color: #FFF;
	background-color: #5cb85c !important;
	border-color: #4cae4c !important;
}

.active_question_id {
	color: #d4a500;
	background: none;
	border: 0.03rem solid #CCC !important;
}
.clickQue {
	color: #FFF;
	background: #d4a500;
	border: 0.03rem solid #d4a500 !important;
}
.question_title {
	margin-bottom: 1rem;
}
.options {
	position: absolute;
	transform: translateY(-50%);
	top: 50%;
	left: 0.2rem;
}
.icheck-success > input:first-child:checked + label::before, .icheck-success > input:first-child:checked + input[type="hidden"] + label::before {
    border-radius: 50% 50%;
}
.mt-2em{
	margin-top:0.05rem;
}
.w-60b {
    width: 8%;
    margin-left: 3%;
}
.aui-bar {
    position: relative;
    top: 0;
    right: 0;
    left: 0;
    z-index: 10;
    width: 100%;
    min-height: 1.95rem;
    font-size: 0.9rem;
    text-align: center;
    display: table;
}
.mt-15em {
	margin-top: 0.5rem  !important;;
} 
.pl-12em {
    padding-left: 0.5rem;
}  
</style>
</head>
<body class="bg-color-f9">
	<header class="aui-bar aui-bar-nav aui-bar-info ">
		<ul>
			<li class="h-45em">
				<!-- <eq name="customization_type" value="1">
					<a class="pull-left mt-15em pl-12em" onclick="tanchuang()" >
					<img class="w-9em h-19em" src="__STATICS__/apps/page_wechat/public/images/back_info.png" alt="返回" />
				</a>
				</eq>
				<if condition="$type_topic eq '1'" >
				<a class="pull-left mt-15em pl-12em" onclick="tanchuang2()" >
					<img class="w-9em h-19em" src="__STATICS__/apps/page_wechat/public/images/back_info.png" alt="返回" />
				</a>
				<elseif condition="$type_topic eq '2'"/>
				<a class="pull-left mt-15em pl-12em" onclick="tanchuang3()" >
					<img class="w-9em h-19em" src="__STATICS__/apps/page_wechat/public/images/back_info.png" alt="返回" />
				</a>
				<elseif condition="$type_topic eq '2'"/>
				<a class="pull-left mt-15em pl-12em" onclick="tanchuang4()" >
					<img class="w-9em h-19em" src="__STATICS__/apps/page_wechat/public/images/back_info.png" alt="返回" />
				</a>
				</if> -->
				<!-- <a class="pull-left mt-15em pl-12em" onclick="tanchuang()" >
					<img class="w-9em h-19em" src="__STATICS__/apps/page_wechat/public/images/back_info.png" alt="返回" />
				</a>-->
				<neq name="zhengshi" value="1">
					<neq name="moni" value="1">
						<eq name="type_topic" value="1">
						<!-- <a class="pull-left mt-15em pl-12em" href="javascript:history.go(-3);" > -->
							<a class="pull-left mt-15em pl-12em" onClick="javascript:history.go(-3);" >
							<img class="w-9em h-19em" src="__STATICS__/apps/page_wechat/public/images/back_info.png" alt="返回" />
						</a>
						<else/>
						<a class="pull-left mt-15em pl-12em" href="javascript:history.back(-1)" >
							<img class="w-9em h-19em" src="__STATICS__/apps/page_wechat/public/images/back_info.png" alt="返回" />
						</a>
						</eq>
					<else/>
						<a class="pull-left mt-15em pl-12em" onclick="tanchuang()" >
							<img class="w-9em h-19em" src="__STATICS__/apps/page_wechat/public/images/back_info.png" alt="返回" />
						</a>
					</neq>
				<else/>
					<a class="pull-left mt-15em pl-12em" onclick="tanchuang1()" >
						<img class="w-9em h-19em" src="__STATICS__/apps/page_wechat/public/images/back_info.png" alt="返回" />
					</a>

				</neq>
				<a class="pull-right mt-15em pr-12em " id="opencard">
			    	<img class="w-20em h-20em" src="__STATICS__/apps/page_wechat/public/images/edu_dati.png" alt="答题卡">
			    </a>
			</li>
		</ul>
	</header>
	<div id="aui-content">
		<div class="content_time_num clearfix">
			<div id="timer" class="pull-left">
				<div class="false">
					<eq name="zhengshi" value="1">
						<span>剩余时间 </span>
						<span class="time minute">{$exam_list.exam.exam_time}</span>:
						<span class="time second">00</span>
					</eq>
					<eq name="moni" value="1">
						<span>剩余时间</span>
						<span class="time minute">{$exam_list.exam.exam_time}</span>:
						<span class="time second">00</span>
					</eq>
					<neq name="zhengshi" value="1">
					<neq name="moni" value="1">
						<div class="clearfix">
							<div class="pull-left mr-5em">得分:</div>
							<div class="color-red pull-left mt-2em" id="income_point" style="font-size: 0.85rem !important;">{$exam_list['branch']['log_score']}</div>
						</div>
						<img class="po-ab w-60b top-18em left-30em" src="__STATICS__/apps/page_wechat/public/images/sanpie.png">
					</neq>
					</neq>
				</div>
			</div>
			<div class="content_num pull-right">
				<span class="num questioned">&nbsp;1</span>&nbsp;/
				<span class="question_sum">{$count_num}</span>
			</div>
		</div>
		<div class="content_main">
			<div class="content_class">
				<div class="content_class_tit clearfix">
					<div class="content_class_tit_left pull-left">
						<i></i>
						<span class="questions_type">选择题</span>
					</div>
					<div class="content_class_tit_right pull-right next" id="nextQuestion">
						<a href="javascript:;">下一题</a>
					</div>
					<div class="content_class_tit_right pull-right submitQuestions" style="display: none">
						<form action="{:U('Edu/set_edu_exam_questions')}"  id="forms" class="p5-editor-add"  method="post">
							<input type="hidden" name="exam_time" value="{$exam_list.exam.exam_time}">
							<input type="hidden" name="exam_id" value="{$exam_list.exam.exam_id}">
							<input type="hidden" id="questions_arr" name="questions_arr" >
							<input type="hidden" id="questions_arr_rr" name="questions_arr_rr" >
							<input type="hidden" id="str_questions_id" name="str_questions_id" >
							<input type="hidden" value="{$type_topic}" name="type_topic" >
							<input type="hidden" value="{$zhuanti}" name="zhuanti" >
							<input type="hidden" id="time_lave" name="time_lave" >
						<a onclick="openSub()">提交试卷</a>
						</form>

					</div>
				</div>
				<!-- 显示解析按钮 -->
				<input type="hidden" id="moni" value="{$moni}">
				<input type="hidden" id="zhengshi" value="{$zhengshi}">
				<div class="quiz">
					<div class="content_classes slide active-slide">
						<ul class="list-unstyled question">
							<p class="question_title"></p>
							<div id="question_list"></div>
						</ul>
						<neq name="zhengshi" value="1">
						<div class="content_class_answer pull-right">
							<img src="" alt="">
							<a href="javascript:;">查看解析</a>
						</div>
						</neq>
						<neq name="moni" value='1'>
						<neq name="zhengshi" value='1'>
						<div id="my_daan">我的答案</div>
						</neq>
						</neq>
					</div>
				</div>
			</div>
			<!-- 答案解析 -->
			<div class="content_class answer_analysis" style="display: none">
				<div class="content_class_tit clearfix">
					<div class="content_class_tit_left pull-left">
						<i></i>
						<span>答案解析</span>
					</div>
				</div>
				<div class="content_classes">
					<p class="correct_answer">正确答案：<span class="xuanxiang">B</span></p>
					<div class="content_classes_msg"><span class="answer_true"></span><span class="answer_memo"></span></div>
				</div>
			</div>
		</div>
	</div>


	<!-- 选项卡 遮罩层 -->
	<section class="po-fix w-100b h-100b top-0em left-0em bg-color-000 z-index-mask" style="display: none" id="">
		<div class="po-ab bottom-0em w-100b bg-color-whiter edu_mask_radius h-97b">
			<div class="mask_close clearfix pt-16em">
				<img class="w-12em h-12em pull-right pr-16em" src="__STATICS__/apps/page_wechat/public/images/mask_close.png">
			</div>
			<div class="f-20em color-21 icon_medium text-align m-a w-180em">答题卡</div>
			<div class="f-12em color-9e icon_regular text-align m-a w-180em">共{$count_num}道题</div>
			<!-- 选择题 &nbsp;&nbsp;&nbsp;-->
			<div class="mt-30em">
				<div class="clearfix">
					<div class="pull-left w-8em ml-25em mt-8em h-8em background-d4a500 bor-ra-50b"></div>
					<div class="pull-left f-16em color-21 ml-12em">题目</div>
				</div>
				<div class="list list1 clearfix" id="answerCard">
					<ul>
					</ul>
				</div>
			</div>

			<!-- 提交试卷 -->
			<div class="submit_test submitQuestions">
				<!-- <a class="btns">提交试卷</a> -->
			</div>
		</div>
	</section>
	<!-- /选项卡 遮罩层 -->

	<!-- 得分 遮罩层 -->
	<section class="edu_analysis_mask" style="display:none">
		<div class="po-fix w-100b h-100b top-0em left-0em bg-color-000 z-index-mask">
			<div class="edu_mask_radius_25em w-80b h-50b bg-color-whiter po-ab top-20b left-10b">
				<div><img src="__STATICS__/apps/page_wechat/public/images/exam_fenxi.png"></div>
				<div class="po-ab top-5b left-5b">
					<div class="f-18em color-21">本次考试所得总分：</div>
					<div class="color-ff4242 f-50em mt-5mem">90分</div>
				</div>
				<div class="clearfix po-ab top-40b color-66 f-16em">
					<div class="pull-left ml-20em">
						<div>正确率：<span>50%</span></div>
						<div class="mt-10em">答题数：<span>20</span></div>
					</div>
					<div class="pull-left ml-25em">
						<div>用时：<span>50%</span></div>
						<div class="mt-10em">积分：<span>0</span></div>
					</div>
				</div>
				<!-- 学习分析 答案解析 -->
				<div class="clearfix po-ab top-80b left-10b">
					<div class="pull-left edu_exam_analysis text-align f-15em color-ff4242"
						onclick="edu_exam_analysis('edu_exam_analysis_header')">学习分析</div>
					<div class="pull-left edu_exam_Answer text-align f-15em color-fff ml-12em">答案解析</div>
				</div>
			</div>
		</div>
	</section>
	<!-- 得分 遮罩层end -->
	<!-- 得分 遮罩层end -->

<!-- 用来存取数据 -->
<input type="hidden" id="uuuuu" >
<input type="hidden" id="length" value="{$length}">
<input type="hidden" id="length_sub">
<div style="display: none" id="strBtn">{$exam_list1}</div>

<script type="text/jscript" src="__STATICS__/apps/page_wechat/public/js/jquery.min.js"></script>

<!-- api核心js -->
<script type="text/jscript" src="__STATICS__/apps/page_wechat/public/js/api.js"></script>
<!-- end -->
<!-- aui下拉刷新js -->
<script type="text/jscript" src="__STATICS__/apps/page_wechat/plugins/aui/js/aui-pull-refresh.js"></script>
<!-- end -->
<!-- aui轮播 -->
<script type="text/jscript" src="__STATICS__/apps/page_wechat/plugins/aui/js/aui-slide.js"></script>

<!-- end -->
<!-- 项目公共js -->
<script type="text/jscript" src="__STATICS__/apps/page_wechat/public/js/sp_public_p5boss.js"></script>

<!-- meaasge -->
<script type="text/jscript" src="__STATICS__/apps/page_wechat/public/js/message.min.js"></script>
<!-- end -->
<!-- 本页面js -->
<!-- <script type="text/jscript" src="__STATICS__/apps/page_wechat/edu/js/edu_exam_info.js"></script> -->
<script src="http://cdn.jsdelivr.net/npm/eruda"></script>
<script>
	
</script>

<script type="text/jscript">
	
function tanchuang(){
	var aaa= window.confirm ('确定要退出吗？');
	if(aaa){
		window.location.href="javascript:history.back(-1)"; 
	}
}
function tanchuang1(){
	var aaa= window.confirm ('请确认是否交卷?');
	if(aaa){
		$('#forms').submit();
	}
}
function openSub(){
	var length = $('#length').val();
	var length_sub = $('#length_sub').val();
	if(length == length_sub){
		$('#forms').submit();
	}else{
		alert('选项不能为空！！！');
	}
}
// 时间倒计时
var minute1= $('.minute').html();
var maxtime = 60 * minute1;//一个小时，按秒计算，自己调整!
function CountDown() {
	if (maxtime >= 0) {
		minutes = Math.floor(maxtime / 60);
		minutes = minutes < 10 ? '0' + minutes : minutes;
		seconds = Math.floor(maxtime % 60);
		seconds = seconds < 10 ? '0' + seconds : seconds;
		msg = `<span>剩余时间 </span>
				<span class="time minute">${minutes}</span>:
				<span class="time second">${seconds}</span>`
		document.all["timer"].innerHTML = msg;
		var lave = minutes+":"+seconds;
		$('#time_lave').val(lave);
		if (maxtime == 5 * 60) $.message({
			message: '考试还剩5分钟',
			type: 'info'
		})
		--maxtime;
	} else {
		clearInterval(timer)
	}
}
timer = setInterval("CountDown()", 1000)
var activeQuestion = 0; //当前操作的考题编号
var questioned = 0; //
var currentSlide = 0;
var checkQues = []; //已做答的题的集合
var itemList = ["A", "B", "C", "D", "E", "F"];
showQuestion(0)
answerCard();

	//展示考卷信息
function showQuestion(id) {
	$(".questioned").text(id + 1);
	var aa = JSON.parse($("#strBtn").html());
	var text = aa.questions_list;
	questioned = (id + 1) / text.length;
	if (activeQuestion != undefined) {
		var moni = $("#moni").val();
		var zhengshi = $("#zhengshi").val();
		if(moni == '1'){
			if(zhengshi == '1'){
				$("#ques" + activeQuestion).removeClass("question_id").addClass("active_question_id");
			}
		}

		
	}
	activeQuestion = id
	$(".question").find(".question_info").remove();

	var question = text[id];
	// console.log(question);
	

	// console.log(question.questions_type);//多选单选类型
	$("#uuuuu").val(question.questions_id);
	$(".question_title").html("<strong>" + (id + 1) + "  、</strong>" + question.questions_title);
	$("#my_daan").html('我的答案：'+question.my_questions_item);

	$(".questions_type").html(question.questions_type);
	$(".xuanxiang").html(question.questions_answer);
	$('.content_classes_msg .answer_memo').html(question.memo)
	var items = question.questions_item;
	var itemDiv = "";
	var item = "";
	var trues = question.questions_type == '单选题' ? true : false;
	// var my_questions_item_arr = '';
	// if(trues==false){
	// 	my_questions_item_arr = .split(',');
	// }
	var questions_id = question.questions_id;
	console.log(question.questions_id);
	if(question.my_questions_item != null){

		for (var i = 0; i < items.length; i++) {
			itemDiv += '<li class="question_info content_classes_bots radio icheck-success" id="item' + i + '">'
			if (trues) {
				if(question.my_questions_item == itemList[i] && question.my_questions_item != question.questions_answer){
					itemDiv += ' <input type="radio" data-val="'+itemList[i]+'" name="item" id="success' + itemList[i] + '" value="' + itemList[i] + '" >'
				}else if(question.my_questions_item == itemList[i] && question.my_questions_item == question.questions_answer){
					itemDiv += ' <input type="radio" data-val="'+itemList[i]+'" name="item" id="success' + itemList[i] + '" value="' + itemList[i] + '" checked>'
				}
			} else {
				if(question.questions_answer.indexOf(itemList[i]) != -1 && question.my_questions_item.indexOf(itemList[i]) != -1){
					
					itemDiv += ' <input type="checkbox" data-val="'+itemList[i]+'" name="item'+i+'" id="success' + itemList[i] + '" value="' + itemList[i] + '" checked>'

				}else{
					itemDiv += ' <input type="checkbox" data-val="'+itemList[i]+'" name="item'+i+'" id="success' + itemList[i] + '" value="' + itemList[i] + '" >'
				}
				
			}
			itemDiv += ' <label for="item'+i+'" style="position: relative;">'
			if (trues) {
				if(question.my_questions_item == itemList[i] && question.my_questions_item != question.questions_answer){
					itemDiv += '  <span class="xuanxiang' +questions_id + i + ' options"  style="width:1.2rem;height:1.2rem;position:absolute;transform:translateY(-50%);top:50%;left:0%"><img src="__STATICS__/apps/page_wechat/public/images/false.jpg" alt="答题卡"></span><span class="pull-right" style="padding-left:1rem;display:block">' + items[i].substring(2) + '</span>'
				}else{
					if(question.my_questions_item==itemList[i]){
						itemDiv += '<span class="xuanxiang' +questions_id + i + ' options" ></span><span class="pull-right" style="padding-left:1rem;display:block">' + items[i].substring(2) + '</span>'
					}else{

						itemDiv += '<span class="xuanxiang' +questions_id + i + ' options" >' + itemList[i] + '.</span><span class="pull-right" style="padding-left:1rem;display:block">' + items[i].substring(2) + '</span>'

					}

				}
			}else{
				if(question.my_questions_item.indexOf(itemList[i]) != -1 && question.questions_answer.indexOf(itemList[i]) == -1){
					itemDiv += '  <span class="xuanxiang' +questions_id + i + ' options" style="width:1.2rem;height:1.2rem;position:absolute;transform:translateY(-50%);top:50%;left:0%"><img src="__STATICS__/apps/page_wechat/public/images/false.jpg" alt="答题卡"></span><span class="pull-right" style="padding-left:1rem;display:block">' + items[i].substring(2) + '</span>'
				}else{
					if(question.my_questions_item.indexOf(itemList[i]) != -1){
						itemDiv += ' <span class="xuanxiang' +questions_id + i + ' options" ></span><span class="pull-right" style="padding-left:1rem;display:block">' + items[i].substring(2) + '</span>'

					}else{
						itemDiv += ' <span class="xuanxiang' +questions_id + i + ' options" >' + itemList[i] + '.</span><span class="pull-right" style="padding-left:1rem;display:block">' + items[i].substring(2) + '</span>'

					}
				}
			}
			itemDiv += ' </label>'
			itemDiv += '</li>'
			// console.log(itemDiv);
			$("#question_list").html(itemDiv);
		}
	}else{
		
		for (var i = 0; i < items.length; i++) {
			
			itemDiv += '<li class="question_info content_classes_bots radio icheck-success" onclick="clickTrim(this)" id="item' + i + '">'
			if (trues) {
				itemDiv += ' <input type="radio" data-val="'+itemList[i]+'" name="item" id="success' + itemList[i] + '" value="' + itemList[i] + '">'
			} else {
				itemDiv += ' <input type="checkbox" data-val="'+itemList[i]+'" name="item'+i+'" id="success' + itemList[i] + '" value="' + itemList[i] + '">'
			}
			itemDiv += ' <label for="item'+i+'" style="position: relative;">'
			itemDiv += '   <span class="xuanxiang' + i + ' options" >' + itemList[i] + '.</span><span class="pull-right" style="padding-left:1rem;display:block">' + items[i].substring(2) + '</span>'
			itemDiv += ' </label>'
			itemDiv += '</li>'
			$("#question_list").html(itemDiv);
		}
	}
	$(".question").attr("id", "question" + id);
	$("#ques" + id).removeClass("active_question_id").addClass("question_id");

	for (var i = 0; i < checkQues.length; i++) {
		// if (checkQues[i].id == id) {
		// 	$("#" + checkQues[i].item).find("input").prop("checked", "checked");
		// 	$("#" + checkQues[i].item).addClass("clickTrim");
		// 	$("#ques" + activeQuestion).removeClass("question_id").addClass("clickQue");
		// }

		if (checkQues[i].id == id) {
			if(checkQues[i].type == 1){
				$("#" + checkQues[i].item).find("input").prop("checked", "checked");
				$("#" + checkQues[i].item).addClass("clickTrim");
				$("#ques" + activeQuestion).removeClass("question_id").addClass("clickQue");
			} else {
				if(checkQues[i].answer != undefined){
					$("#question_list").find("input[type='checkbox']:checked").each(function () {
						$(this).prop("checked", false);
					})
					var checkbox_answer_arr = checkQues[i].answer.split('-');

					for (var a = 0; a < checkbox_answer_arr.length; a++) {
						if(trues){
							$("#question_list").find("input[data-val="+checkbox_answer_arr[a]+"]").prop("checked", "checked");
						}else{

							var array_checkbox = checkbox_answer_arr[a].split(',');
							

							for(var g = 0; g<array_checkbox.length; g++){
								$("#question_list").find("input[data-val="+array_checkbox[g]+"]").prop("checked", "checked");

							}
						}
//						$("#" + checkQues[i].item).addClass("clickTrim");
						$("#ques" + activeQuestion).removeClass("question_id").addClass("clickQue");
					}
				}
			}
		}
	}
}

// 下一题
	$("#nextQuestion").click(function () {
		var aa = JSON.parse($("#strBtn").html());
		var text = aa.questions_list;
		if ((activeQuestion + 1) != text.length) showQuestion(activeQuestion + 1);
		showQuestion(activeQuestion);
		$('.answer_analysis').hide()
		if (activeQuestion == text.length - 1) {
			$('#nextQuestion').hide();
			$('.submitQuestions').show();
		}
		if (activeQuestion !== text.length - 1) {
			$('.submitQuestions').hide();
			$('#nextQuestion').show();
		}
		var moni = $("#moni").val();
		var zhengshi = $("#zhengshi").val();
		if(moni != '1'){
			if(zhengshi != '1'){
				$('.submitQuestions').hide();
			}
		}

	})

	var Question;
function clickTrim(source) {
	var id = source.id;
	//let i = id.slice(-1);
	var is_check = $(source).find('input:checkbox').prop('checked');
	var next_element = $(source).find('input:checkbox').length; // 根据checkbo判断是否多选
	if(next_element == 0){
		var type = 1; // 单选
		$("#" + id).find('.options').hide();
		$("#" + id).find('.options').parents('li').siblings().find(".options").show();
	} else {
		var type = 2; // 多选
		$("#" + id).find('.options').hide();
	}
	$("#" + id).find("input").prop("checked", "checked");
	// $("#" + id).find('.options').hide().parents('li').siblings().find(".options").show();
	$("#ques" + activeQuestion).removeClass("question_id").addClass("clickQue");
	var ques = 0;
	// console.log(checkQues);
	for (var i = 0; i < checkQues.length; i++) {
		if (checkQues[i].id == activeQuestion && checkQues[i].item != id) {
			ques = checkQues[i].id;
			checkQues[i].item = id; //获取当前考题的选项ID
			checkQues[i].answer = $("#" + id).find("input[name=item]:checked").val(); //获取当前考题的选项值
		}
	}

	var checkbox_answer_str = '';
	$("#question_list").find("input[type='checkbox']:checked").each(function () {
		var answer_str = $(this).data('val');
		checkbox_answer_str += answer_str+',';
	})
	
	if(checkbox_answer_str != ''){
		checkbox_answer_str = checkbox_answer_str.substring(0,checkbox_answer_str.length-1);
	}
	if(type == 1){ // 单选
		var check = {};
		check.id = activeQuestion; //获取当前考题的编号
		check.item = id; //获取当前考题的选项ID
		check.answer = $("#" + id).find("input[name=item]:checked").val(); //获取当前考题的选项值
		check.type = type; //获取当前考题的选项值
		checkQues.push(check);
	} else {
		var check = {};
		check.id = activeQuestion; //获取当前考题的编号
		check.item = id; //获取当前考题的选项ID
		check.answer = checkbox_answer_str;
		check.type = type; //获取当前考题的选项值
		checkQues.push(check);
	}
	var target = {};
	var uuuu_question_id  = $("#uuuuu").val();
	checkQues.forEach(item => {
		var source = JSON.parse(`{"${item.id + 1}":"${item.answer}"}`); //将数据转换为 JavaScript 对象
		Object.assign(target, source);//拷贝
	});

	var target1=JSON.stringify(target);//将对象转为字符串
	var nbnnnnn = eval('(' + target1 + ')');
	var num_sub=0;
	$.each(nbnnnnn,function(index,obj){
	  num_sub++;
	});
	$("#length_sub").val(num_sub);

	localStorage.setItem("target",target1);
	var aa = JSON.parse($("#strBtn").html());
	var text = aa.questions_list;
	var str_questions_id = '';
	$("#length").val(text.length);
	for (var i=0; i<text.length;i++) {
		str_questions_id += text[i].questions_id+',';
	}
	$('#str_questions_id').val(str_questions_id);
	$('#questions_arr').val(target1);
	// console.log($('#questions_arr').val())
	$(".question_info").each(function () {
		var otherId = $(this).attr("id");
		if (otherId != id) {
			if(next_element == 0){ //radio
				$("#" + otherId).find("input").prop("checked", false);
			} else {
				if(is_check == true){
					$(source).find("input:checkbox").prop("checked", false);
					$(source).find('.options').show()
					var check_length = $("#question_list").find("input[type='checkbox']:checked").length;
					if(check_length == 0){
						$("#ques" + activeQuestion).removeClass("question_id").removeClass("clickQue");
					}
					var checkbox_answer_str2 = '';
					$("#question_list").find("input[type='checkbox']:checked").each(function () {
						var answer_str = $(this).data('val');
						checkbox_answer_str2 += answer_str+',';
					})
					if(checkbox_answer_str2 != ''){
						checkbox_answer_str2 = checkbox_answer_str2.substring(0,checkbox_answer_str2.length-1);
					}
					var check = {};
					check.id = activeQuestion; //获取当前考题的编号
					check.item = id; //获取当前考题的选项ID
					check.answer = checkbox_answer_str2;
					check.type = type; //获取当前考题的选项值
					console.log(check);
					checkQues.push(check);
					var target = {};
					checkQues.forEach(item => {
						var source = JSON.parse(`{"${item.id + 1}":"${item.answer}"}`); //将数据转换为 JavaScript 对象
						Object.assign(target, source);//拷贝
				
					});
					  	
					var target1=JSON.stringify(target);//将对象转为字符串\
					
					localStorage.setItem("target",target1);
				}
			}
			$("#" + otherId).removeClass("clickTrim");
		}
	})
	Question = activeQuestion;

	// var question_id1 = $("#uuuuu").val();
	// console.log(Question);
	// console.log(activeQuestion);
	// console.log(ques);
	// if (checkQues.length == 0 || Question != activeQuestion && activeQuestion != ques) {
		// var check = {};
		// check.id = question_id1; //获取当前考题的编号
		// check.item = id; //获取当前考题的选项ID
		// check.answer = $("#" + id).find("input[name=item]:checked").val(); //获取当前考题的选项值
		// checkQues.push(check);
		// console.log(checkQues);
	// }


	// var target = {};
	

	// checkQues.forEach(item => {
	// 	var source = JSON.parse(`{"${item.id}":"${item.answer}"}`); //将数据转换为 JavaScript 对象
	// 	Object.assign(target, source);//拷贝
		
	// });
	//   

	// // var arr = Object.keys(target).map(function (key) { return target[key]; });
	// // console.log()
	
	// var target1=JSON.stringify(target);//将对象转为字符串
	// console.log(target1);
	// $('#questions_arr').val(target1);
	// localStorage.setItem("target",target1); 
		



	// $(".question_info").each(function () {
	// 	var otherId = $(this).attr("id");
	// 	if (otherId != id) {
	// 		$("#" + otherId).find("input").prop("checked", false);
	// 		$("#" + otherId).removeClass("clickTrim");
	// 	}
	// })
	// Question = activeQuestion;
}

/*答题卡*/
function answerCard() {
	var text = JSON.parse($("#strBtn").html()).questions_list;
	$(".question_sum").text(text.length);

	var moni = $("#moni").val();
	var zhengshi = $("#zhengshi").val();
	for (var i = 0; i < text.length; i++) {
		if(moni != '1'){
			if(zhengshi != '1'){
				var questionId ="<li id='ques" + i + "'onclick='saveQuestionState(" + i +")' class='questionId  pull-left question_id_yikao'>" +(i + 1) +"</li>";
			}else{
				var questionId ="<li id='ques" + i + "'onclick='saveQuestionState(" + i +")' class='questionId  pull-left'>" +(i + 1) +"</li>";
			}
		}else{
			var questionId ="<li id='ques" + i + "'onclick='saveQuestionState(" + i +")' class='questionId  pull-left'>" +(i + 1) +"</li>";
		}
		
		$("#answerCard ul").append(questionId);
	}
}

/*保存考题状态 已做答的状态*/
function saveQuestionState(clickId) {
	$('.z-index-mask').hide();
	$('.answer_analysis').css('display', 'none')
	showQuestion(clickId)
	var text = JSON.parse($("#strBtn").html()).questions_list
	//console.log(text);
	//console.log(activeQuestion);
		// activeQuestion是当前操作的考题编号
		showQuestion(activeQuestion);
		if (activeQuestion == text.length-1) {
			$('#nextQuestion').hide();
			var moni = $("#moni").val();
			var zhengshi = $("#zhengshi").val();
			if(moni==1 || zhengshi==1 ){
				$('.submitQuestions').show();
			}
		}
		if (activeQuestion !== text.length-1) {
			$('.submitQuestions').hide();
			$('#nextQuestion').show();
		}
}

// 打开学习卡
$('#opencard').click(function () {
	$('.z-index-mask').show();
})
// 关闭学习卡
$('.mask_close').click(function () {
	$('.z-index-mask').hide();
})

// 答案解析显示隐藏
var n = 0
$('.content_class_answer').click(function () {
	n++
	if (n % 2 !== 0) {
		$('.answer_analysis').show()
	} else {
		$('.answer_analysis').hide()
	}
})



</script>
	<!--end-->
</body>

</html>