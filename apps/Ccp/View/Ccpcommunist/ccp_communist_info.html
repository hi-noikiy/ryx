<extend name="./apps/Common/Template/temp.html" />
<block name="css">
<link href="__STATICS__/apps/page_index/css/style.css" rel="stylesheet" type="text/css">	
<style>
.member_box .box_l_2 ul li {
    width: 60% !important;
    float: left;
    font-size: 0.24rem;
    color: #666;
    margin-bottom: 0.3rem;
}
.btn1 {
    cursor: pointer;
    text-align: center;
    width: 1.06rem;
    height: 0.5rem;
    line-height: 0.5rem;
    background-color: #ffffff;
    border-radius: 0.07rem !important;
    border: solid 0.01rem #ef311e;
    color: #f0352b;
    font-size: 0.24rem;
	margin-right: 0.1em;
}
.ml-02mem-cur {
    margin-left: 0.03rem !important;
}
/*整体部分*/ 
::-webkit-scrollbar
{
	width: 0.05rem;
	height: 0.05rem;
}
/*滑动轨道*/ 
::-webkit-scrollbar-track
{
	border-radius: 0px;
	background: none;
}
/*滑块*/
::-webkit-scrollbar-thumb
{
	border-radius: 0.03rem;
	-webkit-box-shadow: inset 0 0 0.06rem rgba(0,0,0,.2);
	background-color: rgba(255,255,255,.75)
}
/*滑块效果*/ 
::-webkit-scrollbar-thumb:hover
{
	border-radius: 0.03rem;
	-webkit-box-shadow: inset 0 0 0.06rem rgba(0,0,0,.2);
	background-color: rgba(85, 85, 85, 0.4);
}
.color-ed3129 {
    color: #ed3129;
    font-family: 'wryh-blod';
}

.communist_log{
    background-color: rgb(241, 241, 241);
    border-radius: 0.07rem !important;
}
.article_over_one{
	display: -webkit-box;
	-webkit-box-orient: vertical;
	-webkit-line-clamp: 2;
	overflow: hidden;
}

</style>
</block>
<block name="body">
<div class="layui-fluid layui-form">
    <div class="layui-row layui-col-space5">
		<div class="member_box clearfix" style="background-color:#fff;">
			<div class="tit clearfix">
				<div class="icon pull-left mt-04em-cur"></div>
				<div class="f-30em-cur color-333 pull-left ml-13em-cur wryh_blod">党员详情</div>
			</div>
			<input type="hidden" id="communist_no" value="{$communist.communist_no}" />
			<div class="pull-left box_l mt-4em-cur">
				<div class="box_l_1">
					<div class="clearfix">
						<div class="pull-left">
							<img style="width:1.75rem;height:1.75rem;border-radius: 50% !important;" src="{$communist.communist_avatar}" alt="">
						</div>
						<div class="pull-left ml-02em-cur w-65b">
							<div class="clearfix mt-2em-cur">
								<div class="pull-left color-333 f-32em-cur"><span class="wryh_blod">{$communist.communist_name}</span>&nbsp;&nbsp;<span style="font-size: 18px;"><if condition="$communist.communist_sex eq 0 "> 女 <else/> 男 </if></span> </div> 
								<div class="pull-right">
									<img class="dis-in" style="width: 0.31rem;height: 0.31rem;cursor: pointer;" src="__STATICS__/apps/page_index/img/bianji.png" alt="" onclick="edit({$communist.communist_no});">
								</div>
							</div>
							<div class="color-666 f-24em-cur mt-2em-cur">{$communist.post_no}</div>
							<div class="color-333 f-24em-cur mt-2em-cur">{$communist.party_no}</div>
						</div>
					</div>
					<ul class="clearfix mt-31em-cur">
						<li class="">年龄：{$communist.age}岁</li>
						<li class="">身份证号：{$communist.communist_idnumber}</li>
						<li class="">手机：{$communist.communist_mobile}</li>
						<li class="">入党时间：{$communist.communist_ccp_date}</li>
						<li class="">党龄：{$communist.ccp_age}年</li>
						
					</ul>
				</div>
				<div class="box_l_2">
					<div class="clearfix">
						<div class="dots pull-left"></div>
						<div class="color-ed3129 f-24em-cur f-w pull-left wryh_blod">基本信息</div>
					</div>
					<ul class="clearfix mt-2em-cur">
						<!-- <li>党员编号：<span class="color-333">{$communist.communist_no}</span></li> -->
						<li >籍贯：<span class="color-333 article_over_one" style="width: 75%;float: right;" title="{$communist.communist_paddress}">{$communist.communist_paddress}</span></li>
						<li>民族：<span class="color-333">{$communist.communist_nation}</span></li>
						<li>学校：<span class="color-333 article_over_one" style="width: 75%;float: right;" title="{$communist.communist_school}">{$communist.communist_school}</span></li>
						<li>学历：<span class="color-333">{$communist.communist_diploma}</span></li>
						<li>邮箱：<span class="color-333 article_over_one" style="width: 75%;float: right;" title="{$communist.communist_email}" >{$communist.communist_email}</span></li>
					</ul>
				</div>
				<div class="box_l_3 mt-5em-cur">
					<div class="clearfix">
						<div class="dots pull-left"></div>
						<div class="color-ed3129 f-24em-cur f-w pull-left wryh_blod">党员标签</div>
					</div>
					<ul class="clearfix">		
						<li class="bg-color-37b1f3">{$communist.ccp_age}年党龄</li>
						<neq name="communist.communist_diploma" value="">
						<li class="bg-color-ffaf48">{$communist.communist_diploma}</li>
						</neq>
						<li class="bg-color-ff4b2c">{$communist.dues_amount}元党费</li>
						<neq name="communist.age_distribute" value="">
						<li class="bg-color-37b1f3">{$communist.age_distribute}</li>
						</neq>
						<volist name="communist.communist_label" id="label">
						<li style="background-color: {$label.memo};">{$label.code_name}</li>
						</volist>					
						<li style="cursor: pointer;" onclick="add_label({$communist.communist_no});">新增标签+</li>
					</ul>
				</div>
			</div>
			<div class="pull-right box_r mt-4em-cur">
				<div class="box_r_1">
					<ul class="clearfix">
						<li class="">
							<div class="pull-left mt-4em-cur">
								<img class="dis-in" style="width: 0.52rem;height: 0.52rem;" src="__STATICS__/apps/page_index/img/pd2_icon1.png" alt="">
							</div>
							<div class="pull-left ml-04em-cur mt-35em-cur">
								<div class="color-666 f-24em-cur">党员积分</div>
								<div class="color-ef332b f-39em-cur wryh_blod">{$communist.communist_integral}分</div>
							</div>
						</li>
						<li class="">
							<div class="pull-left mt-4em-cur">
								<img class="dis-in" style="width: 0.44rem;height: 0.51rem;" src="__STATICS__/apps/page_index/img/pd2_icon2.png" alt="">
							</div>
							<div class="pull-left ml-04em-cur mt-35em-cur">
								<div class="color-666 f-24em-cur">学习笔记</div>
								<div class="color-ef332b f-39em-cur wryh_blod">{$communist.notes_count}篇</div>
							</div>
						</li>
						<li class="">
							<div class="pull-left mt-4em-cur">
								<img class="dis-in" style="width: 0.53rem;height: 0.53rem;" src="__STATICS__/apps/page_index/img/pd2_icon3.png" alt="">
							</div>
							<div class="pull-left ml-04em-cur mt-35em-cur">
								<div class="color-666 f-24em-cur">会议活动</div>
								<div class="color-ef332b f-39em-cur wryh_blod">{$communist.meeting_communist_count}次</div>
							</div>
						</li>
						<li class="" style="width: 30%;">
							<div class="pull-left mt-4em-cur">
								<img class="dis-in" style="width: 0.52rem;height: 0.52rem;" src="__STATICS__/apps/page_index/img/pd2_icon4.png" alt="">
							</div>
							<div class="pull-left ml-04em-cur mt-35em-cur">
								<div class="color-666 f-24em-cur">党费</div>
								<div class="color-ef332b f-39em-cur wryh_blod">{$communist.dues_amount}元</div>
							</div>
						</li>
					</ul>
				</div>
				<div class="box_r_2">
					<div class="clearfix">
						<div class="dots pull-left"></div>
						<div class="color-ed3129 f-24em-cur f-w pull-left wryh_blod">党员生活纪实</div>
					</div>
					<ul class="clearfix label">
						<li class="communist_log active" type="0" >全部（{$dev_log_count}）</li>
						<volist name="communist_log" id="log">
						<li class="communist_log " type="{$log.type_no}" >{$log.type_name}（{$log.log_count}）</li>
						</volist>
					</ul>
					<div class="box_timeline" style="margin-top:0rem">
						<ul class="layui-timeline" id="log_content" style="height:5rem;overflow: auto;">
						<volist name="dev_log_list" id="list">
						<li class="layui-timeline-item">
							<i class="layui-icon layui-timeline-axis">
								<img class="dis-in ml-02mem-cur" style="width: 0.25rem;height: 0.26rem;" src="__STATICS__/apps/page_index/img/yuan.png">
							</i>
							<div class="layui-timeline-content layui-text">
								<h3 class="layui-timeline-title">{$list.add_time}</h3>
								<p>
									{$list.log_content}
								</p>
							</div>
						</li>
						</volist>
						</ul>
					</div>
				</div>
			</div>	
		</div>
		<if condition="$communist['approval_no'] !='' && $communist['approval_no'] !='0'">
			<iframe name="main_iframe"  width="100%" height="700px" src="{:U('Oa/Oaapproval/oa_approval_info')}?approval_no={$communist.approval_no}&mode=2&url_no=Ccp/Ccpcommunist/ccp_communist_develop_index"  target="_self" frameborder="0" id="main_iframe" style="margin-top:15px"></iframe>	
		</if>
	</div>
	<div class="layui-footer layui-from" style="text-align: right">
		<eq name="is_type" value="1">
			<div class="btn1 pull-right mt-04em-cur" style="margin-right: 40px;" onclick="layer_colse();">返回</div>  
		<else/>
			<if condition="$type eq 3">
				<div class="btn1 pull-right mt-04em-cur" style="margin-right: 40px;" onclick="layer_colse();">返回</div>  
			<elseif condition='$communist_type eq 1'/>
				<div class="btn1 pull-right mt-04em-cur" style="margin-right: 40px;" onclick="layer_colse();">返回</div>
			<else/>
				<a class="btn1 pull-right mt-04em-cur" style="margin-right: 40px;" href="{:U('Ccpfail/ccp_communist_fail_index')}">返回</a>
			</if>
		</eq>
	</div>
</div>
</block>
<block name="js">
<script type="text/javascript" src="__STATICS__/plugins/jquery.min.js" ></script>			
<script src="__STATICS__/apps/page_index/js/member_details.js" type="text/javascript"></script>	
<script>

layui.use([ 'form', 'laydate','formSelects'], function() {
    var $ = layui.$
    , admin = layui.admin
    , element = layui.element
    , layer = layui.layer
    , laydate = layui.laydate
    , form = layui.form
    , formSelects = layui.formSelects;
    form.render();
});
function layer_colse() {
	var index = parent.layer.getFrameIndex(window.name); //获取窗口索引
	parent.layer.close(index);
}
function layer_colse1() {
	var index = layer.getFrameIndex(window.name); //获取窗口索引
	layer.close(index);
}
//编辑
function edit(communist_no){
	var index = layer.open({
	   type: 2,
	   title: false,
	   end:false,
	   closeBtn: 0,
	   shift: 1,
	   content: "{:U('Ccpcommunist/ccp_communist_edit')}?communist_no="+communist_no+"&communist_type=1",
	   area: ['300px', '300px']
	});
	layer.full(index);
}
function add_label(communist_no){
	layer.open({
	   type: 2,
	   title: false,
	   end:false,
	   closeBtn: 0,
	   shift: 1,
	   content: "{:U('Ccpcommunist/ccp_communist_label_add')}?communist_no="+communist_no+"",
	   area: ['500px', '500px']
	});
}


//历程
$('.communist_log').click(function(){
	$(this).addClass("active").siblings().removeClass("active");
	var type_no = $(this).attr("type");
	var communist_no = $("#communist_no").val();
	$('#log_content').empty();
	$.ajax({
		type: "post",
		url: "{:U('Ccp/Ccpcommunist/ccp_communist_info_log')}",
		data: {
			"type_no": type_no,
			"communist_no": communist_no
		},
		async: false,
		success: function (res) {
			$('#log_content').html(res.content)
		}
	});
	
})
</script>
</block>
