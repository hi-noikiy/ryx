<extend name="./apps/Common/Template/temp.html" />
<block name="css">
<style type="text/css">
    #js-grid-juicy-projects{
        margin-left: 0% !important;
    }
    #js-grid-juicy-projects2{
        margin-left: 0% !important;
    }
    .layui-colla-title {
        background-color:#FFFFFF;
    }
</style>
</block>
<block name="body">
<eq name="type" value="1">
<form action="{:U('Ccpcommunist/ccp_communist_status_data_save')}" id="signupForm" class="form-horizontal" method="post">
<input type="hidden" name="communist_id" value="{$communist.communist_id}" />
<input type="hidden" name="communist_no" value="{$communist.communist_no}" />
<div class="layui-col-md12">
    <div class="layui-card-body layui-colla-content layui-form layui-show">
        <div class="layui-row">
            <div class="layui-col-xs6 mt-10">
                <div class="layui-row">
                    <div class="layui-col-xs4 text-r fsize-14 fcolor-65 lh-35"><strong>状态：</strong></div>
                    <div class="layui-col-xs6 fsize-14 fcolor-65 lh-35"> 
                    	<select name="status" lay-filter="aihao" lay-search="" lay-verify='required'>
                            <php>echo getStatusSelect('communist_status',$status,COMMUNIST_STATUS_RETIRE)</php>
                        </select>
                    </div>
                </div>
            </div>
            <div id="status_time" class="layui-col-xs6 mt-10">
                <div class="layui-row">
                    <div class="layui-col-xs4 text-r fsize-14 fcolor-65 lh-35"><strong>时间：</strong></div>
                    <div class="layui-col-xs6 fsize-14 fcolor-65 lh-35"> <input type="text" name="status_date"  id="status_date" autocomplete="off" class="layui-input"></div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="layui-form-item h-100">
    <div class="layui-input-block">
        <div class="layui-footer" style="text-align: right">
            <button class="layui-btn" lay-submit="" lay-filter="component-form-demo1">立即提交</button>
            <button type="reset" class="layui-btn layui-btn-primary mr-40" onclick="layer_colse()">取消</button>
        </div>
    </div>
</div>  
</form>
<else/>
<div class="layui-fluid">
    <div class="layui-row layui-col-space15 layui-collapse" lay-filter="more">
	   <form action="{:U('Ccpcommunist/ccp_communist_develop_save')}" id="signupForm" class="form-horizontal" method="post">
		<input type="hidden" name="communist_id" value="{$communist.communist_id}" />
		<input type="hidden" name="communist_no" value="{$communist.communist_no}" />
        <div class="layui-col-md12">
            <div class="layui-card layui-colla-item">
                <div class="layui-colla-title">  基本信息</div>
                    <div class="layui-card-body layui-colla-content layui-form layui-show">
                        <div class="layui-row">
                        	<div class="layui-col-xs6 mt-10">
                                <div class="layui-row">
                                    <div class="layui-col-xs4 text-r fsize-14 fcolor-65 lh-35"><strong>党员姓名：</strong></div>
                                    <div class="layui-col-xs6 fsize-14 fcolor-65 lh-35"> 
                                    	{$communist.communist_name}
                                    </div>
                                </div>
                            </div>
                            <div class="layui-col-xs6 mt-10">
                                <div class="layui-row">
                                    <div class="layui-col-xs4 text-r fsize-14 fcolor-65 lh-35"><strong>申请时间：</strong></div>
                                    <div class="layui-col-xs6 fsize-14 fcolor-65 lh-35"> 
                                    	{$communist.add_time}
                                    </div>
                                </div>
                            </div>

                            <div class="layui-col-xs6 mt-10">
                                <div class="layui-row">
                                    <div class="layui-col-xs4 text-r fsize-14 fcolor-65 lh-35"><strong>所属支部：</strong></div>
                                    <div class="layui-col-xs6 fsize-14 fcolor-65 lh-35"> 
                                    	{$communist.party_no}
                                    </div>
                                </div>
                            </div>
                            <div class="layui-col-xs6 mt-10">
                                <div class="layui-row">
                                    <div class="layui-col-xs4 text-r fsize-14 fcolor-65 lh-35"><strong>原始状态：</strong></div>
                                    <div class="layui-col-xs6 fsize-14 fcolor-65 lh-35"> 
                                    	{$communist.status}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="layui-col-md12">
            <div class="layui-card layui-colla-item" >
                <div class="layui-colla-title mt-20">变更信息</div>
                <div class="layui-card-body layui-colla-content layui-form layui-show">
                    <div class="layui-row">
                    	<div class="layui-col-xs6 mt-10">
                            <div class="layui-row">
                                <div class="layui-col-xs4 text-r fsize-14 fcolor-65 lh-35"><strong>状态：</strong></div>
                                <div class="layui-col-xs6 fsize-14 fcolor-65 lh-35"> 
                                	<select name="status" id="communist_status"  lay-filter="status" lay-search="" lay-verify='required'>
                                       <php>echo getStatusSelect('communist_status',$status,$communist['status_nos'])</php>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <input type='hidden' value='{$status}' name='current_status'>
                        <div class="layui-col-xs6 mt-10">
                            <div class="layui-row">
                                <div class="layui-col-xs4 text-r fsize-14 fcolor-65 lh-35"><strong>审批模板：</strong></div>
                                <div class="layui-col-xs6 fsize-14 fcolor-65 lh-35"> 
                                	<select name="approval_template" lay-filter="aihao" lay-search="" lay-verify='required'>
                                       <php> echo getOaApprovalTplSelect();</php>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="layui-col-xs6 mt-10" id="communist_date">
                            <div class="layui-row">
                                <div class="layui-col-xs4 text-r fsize-14 fcolor-65 lh-35"><strong>正式入党时间：</strong></div>
                                <div class="layui-col-xs6 fsize-14 fcolor-65 lh-35"> 
                                    <input type="text" name="communist_ccp_date" id="communist_ccp_date" value="" autocomplete="off" class="layui-input" />
                                </div>
                                <span class="fcolor-red fsize-18 lh-35 pl-5">*</span>
                            </div>
                        </div>
                         <div class="layui-col-xs12 mt-10">
                            <div class="layui-row">
                                <div class="layui-col-xs2 text-r fsize-14 fcolor-65 lh-35"><strong>变更说明：</strong></div>
                                <div class="layui-col-xs9 fsize-14 fcolor-65 lh-35"> 
                                	<textarea name="log_content" placeholder="请输入变更说明" class="layui-textarea"></textarea>
                                </div>
                            </div>
                        </div>
                        <div class="layui-col-xs12 mt-10">
	                        <div class="layui-row">
	                            <div class="layui-col-xs2 text-r fsize-14 fcolor-65 lh-35"><strong>上传附件：</strong></div>
	                            <div class="layui-col-xs6 fsize-14 fcolor-65 lh-35">
	                            	<input type="hidden" id="source_name" name="source_name" value=""/>
									<input type="hidden" id="missive_attach" name="log_attach" value="" style="width: 60px">
	                                <button type="button" class="layui-btn" id="party_propagate" onclick="uploader_file('ccp','1','missive_attach','source_name','js-grid-juicy-projects2','2','1')"><i class="layui-icon"></i>上传文件</button>
	                                <div id="js-grid-juicy-projects2" style="height: 100px;">
	                                   <neq name="communist.log_attach" value="">
											<php>echo getUploadHtml($communist['log_attach'],'40');</php>
										</neq>
	                                </div>
	                            </div>
	                        </div>
	                    </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="layui-col-md12" id="yujing">
            <div class="layui-card layui-colla-item">
                <div class="layui-colla-title mt-20">预警提示</div>
                    <div class="layui-card-body layui-colla-content layui-form layui-show">
                    <div class="layui-row">
                        <div class="layui-col-md12 mt-10">
                            <div class="layui-row">
                                <div class="layui-col-xs2 text-r fsize-14 fcolor-65 lh-35"><strong>预警提示：</strong></div>
                                <div class="layui-col-xs2 fsize-14 fcolor-65 lh-35"> 
                                	<b> {$communist.communist_name} 预计 </b>
                                </div>
                                <div class="layui-col-xs2 fsize-14 fcolor-65 lh-35"> 
                                	<input type="text" name="communist_remindtime" required id="start" autocomplete="off" class="layui-input" >
                                </div>
                                <div class="layui-col-xs2 fsize-14 fcolor-65 lh-35"> 
                                    <span class="fcolor-red fsize-18 lh-35 pl-5">*</span>
                                </div>
                                <div class="layui-col-xs2 text-r fsize-14 fcolor-65 lh-35"><strong>状态变更为：</strong></div>
                                <div class="layui-col-xs2 fsize-14 fcolor-65 lh-35"> 
                                	<select id="communist_remindstatus" name="communist_remindstatus" lay-filter="aihao" lay-search="" >
                                       <php>echo getStatusSelect('communist_status',$status,$communist['status_nos'])</php>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="layui-form-item">
	        <div class="layui-input-block">
	            <div class="layui-footer" style="text-align: right">
	                <button class="layui-btn" lay-submit="" lay-filter="component-form-demo1">立即提交</button>
	                <button type="button" class="layui-btn layui-btn-primary mr-40
                    " onclick="layer_colse()">取消</button>
	            </div>
	        </div>
	    </div> 
    	</form>
	    </eq>          
    </div>
</div>			
				
</block>
<block name="js">
<script >

    var status = $('#communist_status').val();
    if(status == '21'){
        $("#yujing").hide();
        $("#communist_date").show();
        $("#communist_ccp_date").attr("required",'required');
        $("#start").attr("required",false);
    }else{
        $("#communist_date").hide();
    }

    
	layui.use([ 'form', 'laydate'], function() {
        var $ = layui.$
        , admin = layui.admin
        , element = layui.element
        , layer = layui.layer
        , laydate = layui.laydate
        , form = layui.form;

        form.render(null, 'component-form-group');
        form.on('select(status)', function(data){
            var res= $("#communist_status").val();
            if(res == 21){
                $("#yujing").hide();
                $("#communist_date").show();
                $("#communist_ccp_date").attr("required",'required');
                $("#start").attr("required",false);
            }else{
                $("#yujing").show();
                $("#communist_date").hide();
                $("#communist_ccp_date").attr("required",false);
                $("#start").attr("required",'required');
            }
            layui.form.render();  
        });
        laydate.render({
            elem: '#communist_ccp_date'
        });
    })
	function layer_colse() {
		var index = parent.layer.getFrameIndex(window.name); //获取窗口索引
		parent.layer.close(index);
	}
	//时间选择器
	laydate.render({
		  elem: '#start' //指定元素
	});
	laydate.render({
		  elem: '#status_date', //指定元素
		  value:'<php> echo date("Y-m-d")</php>'
		  
	});
</script>
</block>