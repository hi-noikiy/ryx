<extend name="./apps/Common/Template/temp.html" />
<block name="css">
<link href="__STATICS__/apps/page_index/new_portrait/css/sp_public_mobile.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="__STATICS__/apps/page_index/new_portrait/css/zTreeStyle.css" type="text/css">
<link href="__STATICS__/apps/page_index/css/style.css" rel="stylesheet" type="text/css">
<style>
.party_details_box .box_r .box_r_1 li {
	margin: 0 auto;
	width: 25%;
	float: left;
	padding-left: 0.2rem;

}
.party_details_box .box_r .box_r_1 li .box_r_1l {
	margin-left: 0.44rem;
	margin-top: 0.25rem;
}
.party_details_box .box_r .box_r_2 .people li {
	margin-right: 0.2rem;
}
.tree_box .tree_box_l {
	margin-top: 0.06rem !important;
}
#tree {
	width: 3.5rem !important;
	margin-left: 0rem;
	z-index: 222;
	height: 7rem !important;
}
.party_details_box .box_r .box_r_2 .people li:first-child {
	width: 25%;
}
/*整体部分*/ 
::-webkit-scrollbar
{
	width: 0.1rem !important;
	height: 0.1rem !important;
}
/*滑动轨道*/ 
::-webkit-scrollbar-track
{
	border-radius: 0px;
	background: none;
}
/*滑块*/
::-webkit-scrollbar-thumb
{
	border-radius: 0.1rem;
	-webkit-box-shadow: inset 0 0 0.06rem rgba(0,0,0,.2);
	background-color: rgba(255,255,255,.75)
}
/*滑块效果*/ 
::-webkit-scrollbar-thumb:hover
{
	border-radius: 0.1rem;
	-webkit-box-shadow: inset 0 0 0.06rem rgba(0,0,0,.2);
	background-color: rgba(85, 85, 85, 0.4);
}


.oa_gradient{  
  	background-image: -webkit-gradient(linear, 0 0, 0 bottom, from(#212121), to(#9e9e9e));  		
    -webkit-background-clip:text; 
    -webkit-text-fill-color:transparent; 
}
</style>
</block>
<block name="body">
<div class="layui-fluid layui-form" >
	<div class="layui-row  layui-col-space5" style="background: #fff;">
		<div class="party_details_box clearfix">
			<div class="pull-left box_l" style="position: fixed;">
				<div class="f-32em-cur color-ef311e wryh_blod box_l_tit"><span>党组织列表</span>
					<a href="{:U('Ccpcommunist/ccp_party_list')}" title="党组织添加" style="text-decoration: none" class="pull-right pr-20" style="font-size: 0.4rem;font-weight: 900;">+</a>
				</div>
				<div class="clearfix tree_box">
					<div class="pull-left tree_box_l">
						<img src="__STATICS__/apps/page_index/new_portrait/img/pd1_icon1.png">
					</div>
					<div class="pull-left ">
						<!-- ztree -->
						<ul id="tree" class="ztree " style="width:260px; overflow:auto;"></ul>
					</div>
				</div>
			</div>
			<div class="pull-right box_r">				
				<div class="box_r_2 clearfix" style="margin-top:0rem">
					<div class="pull-left w-33b">
						<img style="width: 4.72rem;height: 2.67rem;" id="party_avatar" src="{$party_info.party_avatar}">
					</div>
					<div class="pull-right ml-23em-cur w-63b">
						<div class="clearfix">
							<div class="pull-left color-333 f-36em-cur wryh_blod" id="party_name">{$party_info.party_name}</div><div style="margin-top: 0.1rem;float: left" id="party_address"> ({$party_info.party_address})</div>
							<div class="pull-right" style="width: 0.31rem;height: 0.31rem;">
								<img class="dis-in mt-1em-cur" style="width: 0.31rem;height: 0.31rem;cursor: pointer;" src="__STATICS__/apps/page_index/new_portrait/img/bianji.png" onclick="bianji()">
							</div>
						</div>
						<div class="color-666 f-20em-cur mt-31em-cur lh" style="height: 0.6rem;text-overflow: -o-ellipsis-lastline;overflow: hidden;text-overflow: ellipsis;display: -webkit-box;-webkit-line-clamp: 2;-webkit-box-orient: vertical;" id="memo">{$party_info.memo}</div>
						<div class="clearfix mt-35em-cur people">
							<neq name="ava.communist_name" value="无">
							<li class="pull-left" style="cursor: pointer;" onclick="communist_info({$ava['communist_no']})" id="communist_noava">
								<img style="width:0.85rem;height:0.85rem;border-radius: 50% !important;" src="{$ava.communist_avatar}" id="communist_avatar_ava">
								<div class="pull-right ml-02em-cur mt-15em-cur line2 pr-02em-cur">
									<div class="color-333 f-24em-cur" id="ava_communist_name">{$ava['communist_name']}</div>
									<div class="color-ef311e f-20em-cur">支部书记</div>
								</div>
							</li>
							</neq>
							<span id="communist_avatar_list">
								<volist name="communist_avatar_list" id="vo" >
									<li class="pull-left" style="width: 2.2rem;cursor: pointer;" onclick="communist_info({$vo['communist_no']})">
										<img style="width:0.85rem;height:0.85rem;border-radius: 50% !important;" src="{$vo.communist_avatar}">
										<div class="pull-right  mt-15em-cur">
											<div class="color-333 f-24em-cur">{$vo.communist_name}</div>
											<div class="color-ef311e f-20em-cur" style="width:1rem;overflow: hidden;text-overflow: ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;" title="{$vo.post_no}">{$vo.post_no}</div>
										</div>
									</li>
								</volist>
							</span>  
						</div>
					</div>
				
				</div>
				<div class="line1"></div> 
				<div class="box_r_1 clearfix" style="margin-top:0.2rem" >
					<li class="" onclick="communist_num()" style="cursor: pointer;">
						<div class="pull-left">
							<img style="width: 0.58rem;height: 0.48rem;" src="__STATICS__/apps/page_index/new_portrait/img/pd1_icon2.png">
						</div>
						<div class="pull-left box_r_1l">
							<div class="color-666 f-24em-cur">党员总数</div>
							<div class="f-30em-cur color-ef311e wryh_blod" id="communist_num">{$party_info.communist_num}人</div>
						</div>
					</li>
					<li class="" onclick="meeting_num()" style="cursor: pointer;">
						<div class="pull-left">
							<img style="width: 0.54rem;height: 0.56rem;" src="__STATICS__/apps/page_index/new_portrait/img/pd1_icon3.png">
						</div>
						<div class="pull-left box_r_1l">
							<div class="color-666 f-24em-cur">三会一课（本月）</div>
							<div class="f-30em-cur color-ef311e wryh_blod" id="meeting_num">{$meeting_num}次</div>
						</div>
					</li>
					<li class="" onclick="dues_amount()" style="cursor: pointer;">
						<div class="pull-left">
							<img style="width: 0.51rem;height: 0.51rem;" src="__STATICS__/apps/page_index/new_portrait/img/pd1_icon4.png">
						</div>
						<div class="pull-left box_r_1l">
							<div class="color-666 f-24em-cur">党费（本月）</div>
							<div class="f-30em-cur color-ef311e wryh_blod" id="dues_amount">{$party_info.dues_amount}元</div>
						</div>
					</li>
					<li class="">
						<div class="pull-left">
							<img style="width: 0.54rem;height: 0.56rem;" src="__STATICS__/apps/page_index/new_portrait/img/pd1_icon5.png">
						</div>
						<div class="pull-left box_r_1l">
							<div class="color-666 f-24em-cur">下级党支部</div>
							<div class="f-30em-cur color-ef311e wryh_blod" id="partychild">{$child_list_count}个</div>
						</div>
					</li>
				</div>
			    <div class="line1"></div> 			   
				<div class="box_r_3 mt-07em-cur" >
					<div class="tit clearfix">
						<div class="icon pull-left mt-04em-cur"></div>
						<div class="f-30em-cur color-333 pull-left ml-13em-cur wryh_blod">下级党支部<span class="color-ef311e wryh" id="child_list_count_st"> ({$child_list_count})</span></div>
					</div>
					<div class="clearfix qi " id="party_index_list" <gt name="party_list_count" value="8">style="height: 2.5rem;"</gt> >
						<neq name="party_list" value="0">
						<volist name="party_list" id="voo">
							<!-- <li onclick="party_info({$voo.party_no})"> -->
							<li>
								<div class="pull-left">
									<img class="dis-in mt-15em-cur" style="width: 0.46rem;height: 0.4rem;" src="__STATICS__/apps/page_index/new_portrait/img/pd1_qi.png">
								</div>
								<div class="pull-left ml-15em-cur">
									<div class="color-333 wryh_blod f-24em-cur" style="width: 2.3rem;overflow: hidden;text-overflow: ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;" title="{$voo['party_name']}">{$voo['party_name']}</div>
									<div class="color-999 f-20em-cur mt-01em-cur">党员：{$voo.communist_party_num}人     会议：{$voo['meeting_count']}次</div>
								</div>
							</li>
						</volist>
						<else />
						<div class="mt-35em-cur">暂无数据</div>
						</neq>
					</div>					
				<gt name="party_list_count" value="8">
				<!-- 展示全文-->	
				 <div class="expand_text text-align " style="margin-top:0.5rem;" onclick="expand_text()">
					<span class="mr-5em">展示全部</span>
					<img src="__STATICS__/apps/page_index/img/zhankai.png">
				 </div>
				<!-- 收起-->	
				 <div class="expand_stop text-align di-n" style="margin-top:0.5rem;" onclick="expand_stop()">
					<span class="mr-5em">收起</span>
					<img src="__STATICS__/apps/page_index/img/shouqi.png">
				 </div>
				 </gt>
				</div>
				<div class="line3"></div> 
				<div class="box_r_4 mt-4em-cur">
					<div class="clearfix">
						<div class="pull-left">
							<div class="tit clearfix">
								<div class="icon pull-left mt-04em-cur"></div>
								<div class="f-30em-cur color-333 pull-left ml-13em-cur wryh_blod">党内活动<span class="color-ef311e wryh" id="meeting_num2"> ({$meeting_num})</span></div>
							</div>
						</div>
						<div class="pull-right f-24em-cur color-ff4330 wryh" onClick="metting_more();" style="cursor: pointer;">
							更多>
						</div>
					</div>
					<div class="clearfix mt-35em-cur" id="meeting_list">
						<neq name="meeting_num" value='0'>
						<volist name="meeting_list" id="metting"> 
						<div class="pull-left w-50b over-h" onclick="meeting_list_onclick({$metting.meeting_no})" style="cursor: pointer;">
							<img class="pull-left w-40b" style="width: 2.79rem;height: 1.68rem;" src="{$metting.meetting_thumb}">
							<div class="pull-left ml-13em-cur w-55b">
								<div class="f-24em-cur color-333" style="overflow: hidden;text-overflow: ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;" title="{$metting.meeting_name}">{$metting.meeting_name}</div>
								<div class="f-24em-cur color-999 mt-35em-cur clearfix">
									<span class="pull-left">时间:{$metting.meeting_start_time}</span>
									<span class="pull-right">状态:{$metting.status}</span>
								</div>
								<div class="f-24em-cur color-999 mt-2em-cur">
									<span class="pull-left"  style="width: 3.5rem;overflow: hidden;text-overflow: ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;" title="{$metting.meeting_addr}">地点:{$metting.meeting_addr}</span>
								</div>
							</div>
						</div>
						</volist>
						<else />
						暂无数据
						</neq>
					</div>
				</div>
				
				<div class="line3"></div>   
				<div class="box_r_5 mt-4em-cur">
					<div class="clearfix">
						<div class="pull-left">
							<div class="tit clearfix">
								<div class="icon pull-left mt-04em-cur"></div>
								<div class="f-30em-cur color-333 pull-left ml-13em-cur wryh_blod" >党内动态<span class="color-ef311e wryh" id="cms_article_count"> ({$cms_article_count})</span></div>
							</div>
						</div>
						<div class="pull-right f-24em-cur color-ff4330 wryh" onClick="article_more();" style="cursor: pointer;">
							更多>
						</div>
					</div>
					<div class="mt-35em-cur">
						<span id="cms_article_list">
							<neq name="cms_article_count" value="0">
							<volist name="cms_article_list" id="article"> 
							<li class="clearfix" onclick="article_onclick({$article.article_id})" style="cursor: pointer;">
								<div class="pull-left w-20b">									
									<img style="width: 2.79rem;height: 1.67rem;" src="{$article.article_thumb}">
								</div>
								<div class="pull-right w-78b">
									<div class="color-333 f-24em-cur wryh_blod" title="{$article.article_title}">{$article.article_title}</div>
									<div class="color-999 f-24em-cur mt-2em-cur lh-35-cur" style="overflow: hidden;text-overflow: ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;">{$article.article_content}</div>
									<div class="color-666 f-24em-cur mt-15em-cur">阅读量：<span id="article_view">{$article.article_view}</span>次      发布时间：{$article.add_time}</div>
								</div>
							</li>
							</volist>
							<else />
							暂无数据
							</neq>
						</span>
						
					</div>
				</div>
			</div>			
		</div>  
	</div>
</div>
<input type="hidden" id="party_no" >
</block>     
<block name="js">
<script src="__STATICS__/apps/page_index/new_portrait/js/jquery.min.js" type="text/javascript" charset="utf-8"></script>     
<script type="text/javascript" src="__STATICS__/apps/page_index/new_portrait/js/jquery.ztree.core.js"></script>
<script src="__STATICS__/apps/page_index/new_portrait/js/party_details.js" type="text/javascript"></script>
<script>
//展开
function expand_text(){
	$("#party_index_list").removeClass('over-h');	
	$("#party_index_list").height('');
	$('.expand_text').addClass("di-n");
	$(".expand_stop").removeClass("di-n");
	//$("#party_index_list").removeClass('oa_gradient');//渐变
}
//收起
function expand_stop(){
	$('.expand_text').removeClass("di-n");
	$(".expand_stop").addClass("di-n");
	$("#party_index_list").addClass('over-h');	
	$("#party_index_list").height('2.5rem');	
	//$("#party_index_list").addClass('oa_gradient');//渐变
}
//文章详情
function article_onclick(article_id){
	var  article_view = $("#article_view").text();
	var article_view = parseInt(article_view)
	$("#article_view").text(article_view+1);
	var index = layer.open({
		type: 2,
		title: false,
		end:false,
		closeBtn: false,
		shift: 1,
		area : ['800px' , '400px'],
		content: "{:U('Cms/Cmsarticle/cms_article_info')}?article_id="+article_id+"",
	});
	layer.full(index);
}
function meeting_list_onclick(meeting_no){
	var index = layer.open({
		type: 2,
		title: false,
		end:false,
		closeBtn: false,
		shift: 1,
		area : ['800px' , '400px'],
		content: "{:U('Oa/Oameeting/oa_meeting_info')}?meeting_no="+meeting_no+"",
	});
	layer.full(index);
}
function communist_info(communist_no){
	var  ava_communist_name = $("#ava_communist_name").text();
	if(ava_communist_name != "无"){
		var index = layer.open({
			type: 2,
			title: false,
			end:false,
			closeBtn: false,
			shift: 1,
			area : ['800px' , '400px'],
			content: "{:U('Ccp/Ccpcommunist/ccp_communist_info_persondetail')}?communist_no="+communist_no+"",
		});
		layer.full(index);
	}
}
function dues_amount(){
	
	//页面跳转
	var othis = $(this)
	,href = "{:U('Ccp/Ccpdues/ccp_dues_index')}"
	,text = '党费'
	,router = layui.router();
	
	//执行跳转
	var topLayui = parent === self ? layui : top.layui;
	topLayui.index.openTabsPage(href, text || othis.text());  
}
function communist_num(){
	//页面跳转
	var othis = $(this)
	,href = "{:U('ccp_communist_index')}"
	,text = '党员列表'
	,router = layui.router();
	
	//执行跳转
	var topLayui = parent === self ? layui : top.layui;
	topLayui.index.openTabsPage(href, text || othis.text());    

}
function meeting_num(){
	var party_no = $("#party_no").val();
	if(party_no==''){
		party_no = {$party_no};
	}
	 //页面跳转
	var othis = $(this)
		,href = "{:U('Oa/Oameeting/oa_meeting_list')}?party_no="+party_no+""
		,text = '会议列表'
		,router = layui.router();
		
		//执行跳转
		var topLayui = parent === self ? layui : top.layui;
		topLayui.index.openTabsPage(href, text || othis.text());  
}
//$("#tree").css("height","80%");
function onclick(a, b, node) {     //node是代表zNodes里面的urltree属性
	var party_no = node.id;

	$("#party_no").val(party_no);
	if(party_no==1){
		$("#xiaji").show();
	}else{
		$("#xiaji").show();

	}
	$.get("{:U('Ccpcommunist/ccp_party_index_data')}",{party_no:party_no},function(data){
		console.log(data);
		$("#communist_num").text(data.communist_num+"人");
		$("#meeting_num").text(data.meeting_num+"次");
		$("#meeting_num2").text("("+data.meeting_num+")");
		$("#partychild").text(data.partychild+"个");
		$("#child_list_count_st").text("("+data.partychild+")");
		$("#dues_amount").text(data.dues_amount+"元");
		$("#party_address").text('');
		$("#party_name").text(data.dataparty_info.party_name);
		$("#memo").text(data.dataparty_info.memo);
		$("#party_avatar").attr('src',data.dataparty_info.party_avatar);
		//党组织列表

		var party_data = data.party_data;
		if(party_data==null){
			$("#party_index_list").html('<div class="mt-35em-cur">暂无数据</div>');
			$('.expand_text').addClass("di-n");
			$(".expand_stop").addClass("di-n");
		}else{
			var party_data_str = "";
			for (var i = 0; i<party_data.length; i++) {
				party_data_str+=`<li onclick="party_info(${party_data[i].party_no})" style="cursor: pointer;">
					<div class="pull-left">
						<img class="dis-in mt-15em-cur" style="width: 0.46rem;height: 0.4rem;" src="__STATICS__/apps/page_index/new_portrait/img/pd1_qi.png">
					</div>
					<div class="pull-left ml-15em-cur">
						<div class="color-333 wryh_blod f-24em-cur" style="width: 2.3rem;overflow: hidden;text-overflow: ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;" title="${party_data[i].party_name}">${party_data[i].party_name}</div>
						<div class="color-999 f-20em-cur mt-01em-cur">党员：${party_data[i].communist_party_num}人     会议：${party_data[i].meeting_count}次</div>
					</div>
				</li>`;
				if(i > 8){
					$('.expand_text').removeClass("di-n");
					$(".expand_stop").addClass("di-n");
					$("#party_index_list").height('2.5rem');
				}else{
					$('.expand_text').addClass("di-n");
					$(".expand_stop").addClass("di-n");
					$("#party_index_list").height('');
				}
				
				
			}
			$("#party_index_list").html(party_data_str);
		}
		if(data.ava.communist_name == null){
			$("#ava_communist_name").text("无");
			$("#communist_noava").hide();
			$("#communist_avatar_ava").attr("src",data.ava.communist_avatar);
		}else{
			$("#communist_noava").show();
			$("#ava_communist_name").text(data.ava.communist_name);
			$("#communist_avatar_ava").attr("src",data.ava.communist_avatar);
		}
		$("#cms_article_count").text("("+data.cms_article_count+")");

		var meeting_list_arr = data.meeting_list;
		var meeting_list_str = '';
		for (var i = 0; i<meeting_list_arr.length; i++) {
			meeting_list_str+=`<div class="pull-left w-50b over-h" onclick="meeting_list_onclick(${meeting_list_arr[i].meeting_no})" style="cursor: pointer;">
				<img class="pull-left w-40b" style="width: 2.79rem;height: 1.68rem;" src="${meeting_list_arr[i].meetting_thumb}">
				<div class="pull-left ml-13em-cur w-55b">
					<div class="f-24em-cur color-333" style="overflow: hidden;text-overflow: ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;" title="${meeting_list_arr[i].meeting_name}">${meeting_list_arr[i].meeting_name}</div>
					<div class="f-24em-cur color-999 mt-35em-cur clearfix">
						<span class="pull-left">时间:${meeting_list_arr[i].meeting_start_time}</span>
					</div>
					<div class="f-24em-cur color-999 mt-2em-cur">							
						<span class="pull-left"  style="width: 3.5rem;overflow: hidden;text-overflow: ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;" title="${$meeting_list_arr[i].meeting_addr}">地点:${meeting_list_arr[i].meeting_addr}</span>
					</div>
				</div>
			</div>`;
		}
		if(meeting_list_str !=''){
			$("#meeting_list").html(meeting_list_str);
		}else{
			$("#meeting_list").html("暂无数据");

		}

		var communist_avatar_list = data.communist_avatar_list;
		var communist_avatar_list_str = "";
		for (var i = 0; i<communist_avatar_list.length; i++) {
			communist_avatar_list_str += `<li class="pull-left" style="width: 2.2rem;cursor: pointer;" onclick="communist_info(${communist_avatar_list[i].communist_no})">
					<img style="width: 0.85rem;height: 0.85rem;border-radius: 50% !important;" src="${communist_avatar_list[i].communist_avatar}">
					<div class="pull-right  mt-15em-cur">
						<div class="color-333 f-24em-cur">${communist_avatar_list[i].communist_name}</div>
						<div class="color-ef311e f-20em-cur" style="width:1rem;overflow: hidden;text-overflow: ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;" title="${communist_avatar_list[i].post_no}">${communist_avatar_list[i].post_no}</div>
					</div>
				</li>`;
		}
		if(communist_avatar_list.length == 0){
			$("#communist_avatar_list").html(`<div style="margin-top: 0.3rem;">暂无数据</div>`);
		}else{
			$("#communist_avatar_list").html(communist_avatar_list_str);
		}

		var communist_article = data.cms_article_list;
		var communist_article_str = "";
		for (var i = 0; i<communist_article.length; i++) {
			communist_article_str += `<li class="clearfix" onclick="article_onclick(${communist_article[i].article_id})" style="cursor: pointer;">
			<div class="pull-left w-20b">				
				<img style="width: 2.79rem;height: 1.67rem;" src="${communist_article[i].article_thumb}">
			</div>
			<div class="pull-right w-78b">
				<div class="color-333 f-24em-cur wryh_blod" title="${communist_article[i].article_title}">${communist_article[i].article_title}</div>
				<div class="color-999 f-24em-cur mt-2em-cur lh-35-cur" style="overflow: hidden;text-overflow: ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;">${communist_article[i].article_content}</div>
				<div class="color-666 f-24em-cur mt-15em-cur">阅读量：<span id="article_view">${communist_article[i].article_view}</span>次      发布时间：${communist_article[i].add_time}</div>
			</div>
		</li>`;
		}
		if(communist_article_str !=''){
			$("#cms_article_list").html(communist_article_str);
		}else{
			$("#cms_article_list").html("暂无数据");
		}

	})
}
function bianji(){
	var party_no = $("#party_no").val();
	if(party_no==''){
		party_no = {$party_no};
	}
	window.location.href="{:U('ccp_party_edit')}?party_no="+party_no+"";
}

function metting_more(){
	//页面跳转
	 var party_no = $("#party_no").val();
	if(party_no==''){
		party_no = {$party_no};
	}
	var othis = $(this)
	,href = "{:U('Oa/Oameeting/oa_meeting_list')}?party_no="+party_no+""
	,text = '党内活动'
	,router = layui.router();
	
	//执行跳转
	var topLayui = parent === self ? layui : top.layui;
	topLayui.index.openTabsPage(href, text || othis.text());	
	
}
function article_more(){
	var party_no = $("#party_no").val();
	if(party_no==''){
		party_no = {$party_no};
	}
	//页面跳转
	var othis = $(this)
	,href = "{:U('Cms/Cmsarticle/cms_article_index')}?party_no="+party_no+""
	,text = '党内动态'
	,router = layui.router();
	
	//执行跳转
	var topLayui = parent === self ? layui : top.layui;
	topLayui.index.openTabsPage(href, text || othis.text());
}

/**————————————————————————————————ztree插件——————————————————————————————————————**/
var zTree;
var demoIframe;
var setting = {
	data: {
		simpleData: {
			enable: true
		}
	},
	callback: {
		onClick: onclick
	}
};

var zNodes = [ 
<volist name="party_list1" id="party" key="k">     
  {id: {$party.party_no}, pId: {$party.party_pno},name: "{$party.party_name}",<if condition='$k eq 1'>open:true</if>},
</volist>
];
$(document).ready(function () {
  var t = $("#tree");
  t = $.fn.zTree.init(t, setting, zNodes);
  demoIframe = $("#testIframe");
  demoIframe.bind("load", loadReady);
  var zTree = $.fn.zTree.getZTreeObj("tree");
  zTree.selectNode(zTree.getNodeByParam("id", 1));
});
function loadReady() {
  var bodyH = demoIframe.contents().find("body").get(0).scrollHeight,
	htmlH = demoIframe.contents().find("html").get(0).scrollHeight,
	maxH = Math.max(bodyH, htmlH), minH = Math.min(bodyH, htmlH),
	h = demoIframe.height() >= maxH ? minH : maxH;
  if (h < 530) h = 530;
  demoIframe.height(h);
}
</script> 
</block>
