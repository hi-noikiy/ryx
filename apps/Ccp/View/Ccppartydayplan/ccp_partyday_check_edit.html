<extend name="./apps/Common/Template/temp.html" />
<block name="css">
</block>
<block name="body">
	<div class="page-container h-800">
		<div class="page-content-wrapper">
			<div class="page-content ">
				<div class="portlet light bordered right" id="tab_2">
					<div class="portlet-title">
						<div class="caption">
							<div class="cont-col1">
								<div class="label label-sm bg-color-blue">
									<i class="iconfont">&#xe652;</i>
								</div>
							</div>
							<span class="bold "> <php>echo getFunctionInfo(ACTION_NAME);</php>
							</span>
						</div>
					</div>
					<div class="portlet-body">
					<form action="{:U('ccp_partyday_cat_save')}" method="post" id="form_sample_2" class="editor-add">
						<div class="form-body">
						<div class="row">
							
								<div class="alert alert-danger display-hide">
									<button class="close" data-close="alert"></button>
									你输入有错误。请检查下面输入是否正确。
								</div>
								<div class="alert alert-success display-hide">
									<button class="close" data-close="alert"></button>
									您的表单验证成功！
								</div>
								<!-- 输入标题开始   -->
								<div class="form-group  mt-5 col-xs-12 ">
									<div class="row">
										<label class="control-label col-xs-2 pl-0">标题: <span class="required"> * </span>
										</label>
										<div class="col-xs-8 p5-form-control pl-0">
											<div class="input-icon right">
												<i class="fa"></i> <input type="text" class="  form-control " name="partyday_title" value="{$partyday_list.partyday_title}">
											</div>
										</div>
									</div>
								</div>
								
								<!-- 输入标题结束 -->
								<div class="form-group  mt-5 col-xs-12 ">
									<div class="row">
										<label class="control-label col-xs-2 pl-0">活动时间: <span class="required"> * </span>
										</label>
										<div class="col-xs-8 p5-form-control pl-0">
											<div class="input-icon right">
												<i class="fa"></i> <input type="text"  name="partyday_time" value="{$partyday_list.partyday_time}" class="form-control layer-date " placeholder="请选择日期" id="partyday_time"> 
											</div>
										</div>
									</div>
								</div>
								 <div class="form-group mt-5 col-md-12 mb-15">
                                     <div class="row">
                                         <label class="control-label col-md-2 pl-0">审核人员：<span class="required"> *  </span></label>
                                         <div class="col-xs-8 p5-form-control pl-0 ">
                                         	<input id="approval_staff_name" type="text" class="form-control"  value="" name="approval_staff_name" readonly /> 
		                                    <input id="approval_staff_no" type="hidden" class="form-control"  value="" name="approval_staff_no" /> 
                                         </div>
                                         <div class="col-md-1 p5-form-control pl-0 ">
											<button type="button" onclick="select_receive_user_partyday('approval_staff')" class="btn btn-sm blue">选择</button>
                                         </div>
                                     </div>
                                 </div> 
                                 <!-- 文本域开始 -->
								<div class="form-group col-xs-12 mt-10">
									<div class="row">
										<label class="control-label col-xs-2 pl-0 mt-5">活动要求： </label>
										<div class="col-xs-9 pl-0">
											<!-- 可以改变rows="x"的大小，和maxlength="x"的数字大小来控制文本框的大小和字符的多少 -->
											<textarea id="partyday_require" class="  form-control " maxlength="100" rows="3" placeholder="这个文本域的最大长度为100个字符." name="partyday_require">{$partyday_list.partyday_require}</textarea>
										</div>
									</div>
								</div>
								<!-- 文本域结束 -->
								
								<div class="form-group col-xs-12">
									<div class="row">
										<label class="control-label col-xs-2 pl-0 mt-5">活动内容: </label>
										<div class="col-md-9 pl-0">
											<textarea id="editor" name="partyday_content" class="  form-control " rows="3" placeholder=案件内容." name="partyday_content">{$partyday_list.partyday_content}</textarea>
										</div>
									</div>
								</div>
								<div class="form-group mt-5 col-md-12 mb-15">
                                     <div class="row">
                                        <label class="control-label col-md-2 pl-0">附件：</label>
                                        <div class="col-md-10  pl-0" >
											<div class="form-group">
				                                <input type="hidden" id="partyday_name" name="partyday_name" value=""/>
				                                <input type="hidden" id="partyday_attach" name="partyday_attach" value="{$partyday_list.partyday_attach}" style="width: 60px">
				                                <a href="javascript:void(0);" target="_self" onclick="uploader_file('ccp','1','partyday_attach','partyday_name','js-grid-juicy-projects','2','1')" class="btn btn-sm btn-success layer-demolist">点击选择文件</a>
												<div id="js-grid-juicy-projects" class="cbp" style="height:100px">
													<neq name="partyday_list.partyday_attach" value="">
														<php>echo getUploadHtml($partyday_list['partyday_attach'],'40');</php>
													</neq>
												</div>
					                    	</div>
                                         </div>
                                     </div>
                                 </div>
								<div class="col-xs-12">
								<input id="partyday_id" type="hidden" class="form-control"  value="{$partyday_list.partyday_id}" name="partyday_id" /> 
									<button type="button" onclick="history.go(-1);" class="btn btn-sm default w-75 bor-ra-2 pull-right mr-20">取消</button>
									<button type="submit"  class="btn btn-sm blue w-75 bor-ra-2 mr-10 pull-right">提交</button>
								</div>
							</div>
						
						</div>
					</form>
					</div>
				</div>
			</div>
			<!-- END CONTENT -->
		</div>
	</div>
</block>
<block name="js">
<script>
	$('#is_alert').on('ifChanged', function(event){
		$("#alert_time").toggle();
	});
</script>
      <script>
		$(document).ready(function(){
		$(".multiSelect").select2();
		$("#btnSave").click(function(){
		var v =$("#worker").select2("val");
		$("#workers").val(v);
		$("#myform").submit();//myform表单的id
		});
		});
</script>
<script>
	var FormValidation = function () {
		var handleValidation2 = function() {
			var form2 = $('#form_sample_2');
			var error2 = $('.alert-danger', form2);
			var success2 = $('.alert-success', form2);
			form2.validate({
				errorElement: 'span', //default input error message container
				errorClass: 'help-block help-block-error', // default input error message class
				focusInvalid: false, // do not focus the last invalid input
				ignore: "",  // validate all fields including form hidden input
				rules: {
					partyday_title: {
						minlength: 2,
						required: true
					},
					partyday_time: {
						minlength: 2,
						required: true
					},
					approval_staff_name: {
						minlength: 2,
						required: true
					},
					
				},

				invalidHandler: function (event, validator) { //display error alert on form submit              
					success2.hide();
					error2.show();
					App.scrollTo(error2, -200);
				},

				errorPlacement: function (error, element) { // render error placement for each input type
					var icon = $(element).parent('.input-icon').children('i');
					icon.removeClass('fa-check').addClass("fa-warning");  
					icon.attr("data-original-title", error.text()).tooltip({'container': 'body'});
				},

				highlight: function (element) { // hightlight error inputs
					$(element)
						.closest('.form-group').removeClass("has-success").addClass('has-error'); // set error class to the control group   
				},

				unhighlight: function (element) { // revert the change done by hightlight
					
				},

				success: function (label, element) {
					var icon = $(element).parent('.input-icon').children('i');
					$(element).closest('.form-group').removeClass('has-error').addClass('has-success'); // set success class to the control group
					icon.removeClass("fa-warning").addClass("fa-check");
				},

				submitHandler: function (form) {
					success2.show();
					error2.hide();
					form[0].submit(); // submit the form
				}
			});
		}
		var handleWysihtml5 = function() {
			if (!jQuery().wysihtml5) {
				return;
			}
			if ($('.wysihtml5').size() > 0) {
				$('.wysihtml5').wysihtml5({
					"stylesheets": ["../assets/global/plugins/bootstrap-wysihtml5/wysiwyg-color.css"]
				});
			}
		}
		return {
			init: function () {
				handleWysihtml5();
				handleValidation2();
			}
		};
	}();
	jQuery(document).ready(function() {
		FormValidation.init();
	});
	</script>
	<script>
	laydate.render({
		  elem: '#partyday_time',
		  type:'date',   
		  /* 'month', */
		});
	</script>
	<script>
			function select_receive_user_partyday(field_name){
				var url = "{:U('System/Com/com_imail_receiveUser')}?field_name="+field_name+"&type=1&hide=1";
				layer.open({
						type: 2,
						title: '选择联系人',
						maxmin: true,
						offset: window.parent.document.body.scrollTop+20+'px',
						shadeClose: true, //点击遮罩关闭层
						area : ['620px' , '422px'],
						content: url //iframe的url
					});
			}
			</script>
</block>